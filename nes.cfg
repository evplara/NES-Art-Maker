SYMBOLS {
    __STACKSIZE__: type = weak, value = $0300;  # 3 pages C stack
}

MEMORY {
    # Zero page ($0002–$001B used by cc65 runtime)
    ZP:     file = "", start = $0002, size = $001A, type = rw, define = yes;

    # iNES header (16 bytes at start of file)
    HEADER: file = %O, start = $0000, size = $0010, fill = yes;

    # 32KB PRG ROM at $8000–$FFFF
    ROM0:   file = %O, start = $8000, size = $7FFA, fill = yes, define = yes;

    # Hardware vectors at end of PRG
    ROMV:   file = %O, start = $FFFA, size = $0006, fill = yes;

    # 8KB CHR ROM bank (pattern tables)
    ROM2:   file = %O, start = $0000, size = $2000, fill = yes;

    # Internal 2KB RAM (minus zeropage / CPU stack)
    # $0100-$01FF = CPU stack (TXS)
    # $0200-$04FF = PPU/OAM buffers, free for you
    # $0500-$07FF = cc65 parameter stack / scratch
    SRAM:   file = "", start = $0500, size = __STACKSIZE__, define = yes;

    # Cartridge RAM at $6000-$7FFF (used by cc65 for BSS/DATA/heap)
    RAM:    file = "", start = $6000, size = $2000, define = yes;
}

SEGMENTS {
    ZEROPAGE: load = ZP,     type = zp;
    HEADER:   load = HEADER, type = ro;

    STARTUP:  load = ROM0,   type = ro, define = yes;
    LOWCODE:  load = ROM0,   type = ro, optional = yes;
    ONCE:     load = ROM0,   type = ro, optional = yes;
    CODE:     load = ROM0,   type = ro, define = yes;
    RODATA:   load = ROM0,   type = ro, define = yes;
    DATA:     load = ROM0,   run  = RAM, type = rw, define = yes;

    VECTORS:  load = ROMV,   type = rw;
    CHARS:    load = ROM2,   type = rw;

    BSS:      load = RAM,    type = bss, define = yes;
}

FEATURES {
    CONDES: type    = constructor,
            label   = __CONSTRUCTOR_TABLE__,
            count   = __CONSTRUCTOR_COUNT__,
            segment = ONCE;

    CONDES: type    = destructor,
            label   = __DESTRUCTOR_TABLE__,
            count   = __DESTRUCTOR_COUNT__,
            segment = RODATA;

    CONDES: type    = interruptor,
            label   = __INTERRUPTOR_TABLE__,
            count   = __INTERRUPTOR_COUNT__,
            segment = RODATA,
            import  = __CALLIRQ__;
}
